{% extends "main.html" %}
{% load static %}
{% block content %}
  <link rel="stylesheet" href="{% static "css/chat.css" %}">
  <div class="container w-100 mt-2 sticky-top">
    <div class="row">
      <div class="col-md-6 offset-md-3">
        <div class="card">
          <div class="card-header">Chat with {{ request.user.partner }}</div>
          <div id="scrollable" class="card-body scrollable">
            {% for message in conversation %}
              {% if message.user == request.user.partner %}
                <div class="media mb-1 d-flex">
                  <div class="img-fluid">
                    <img class="me-2 mt-1 chat-user-profile" src="{{ message.user.avatar.url }}" alt="">
                  </div>
                  <div class="media-body pe-5">
                    <div class="alert alert-success" role="alert">{{ message.content }}</div>
                  </div>
                </div>
              {% endif %}
              {% if message.user == request.user %}
                <div class="media mb-1 justify-content-end d-flex">
                  <div class="media-body text-right ps-5">
                    <div class="alert alert-primary" role="alert">{{ message.content }}</div>
                  </div>
                  <div class="img-fluid">
                    <img class="ms-2 mt-1 chat-user-profile" src="{{ request.user.avatar.url }}" alt="">
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
          <div class="card-footer">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Type your message" autofocus>
              <div class="input-group-append">
                <button class="btn btn-primary ms-2" type="button">Send</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock content %}
{% block scripts %}
  <script>
      var scrollingDiv = document.getElementById("scrollable");
      scrollingDiv.scrollTop = scrollingDiv.scrollHeight;
      window.scrollTo(0, document.body.scrollHeight);
  </script>
{% endblock scripts %}
